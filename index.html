<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Release Notes" href="changelog.html" />

    <!-- Generated with Sphinx 8.2.1 and Furo 2024.08.06 -->
        <title>watchtower documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="#"><div class="brand">watchtower  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="#">
  
  
  <span class="sidebar-brand-text">watchtower  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><ul>
<li><a class="reference internal" href="#">Watchtower: Python CloudWatch Logging</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li><a class="reference internal" href="#iam-permissions">IAM permissions</a></li>
<li><a class="reference internal" href="#log-group-tagging">Log Group Tagging</a></li>
<li><a class="reference internal" href="#example-flask-logging-with-watchtower">Example: Flask logging with Watchtower</a></li>
<li><a class="reference internal" href="#example-django-logging-with-watchtower">Example: Django logging with Watchtower</a></li>
<li><a class="reference internal" href="#examples-querying-cloudwatch-logs">Examples: Querying CloudWatch logs</a></li>
<li><a class="reference internal" href="#examples-python-logging-config">Examples: Python Logging Config</a></li>
<li><a class="reference internal" href="#log-stream-naming">Log stream naming</a></li>
<li><a class="reference internal" href="#boto3-botocore-urllib3-logs">Boto3/botocore/urllib3 logs</a></li>
<li><a class="reference internal" href="#aws-lambda">AWS Lambda</a></li>
<li><a class="reference internal" href="#authors">Authors</a></li>
<li><a class="reference internal" href="#links">Links</a></li>
<li><a class="reference internal" href="#bugs">Bugs</a></li>
<li><a class="reference internal" href="#versioning">Versioning</a></li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-watchtower">API documentation</a><ul>
<li><a class="reference internal" href="#watchtower.CloudWatchLogFormatter"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogFormatter</span></code></a><ul>
<li><a class="reference internal" href="#watchtower.CloudWatchLogFormatter.format"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogFormatter.format()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#watchtower.CloudWatchLogHandler"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler</span></code></a><ul>
<li><a class="reference internal" href="#watchtower.CloudWatchLogHandler.close"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler.close()</span></code></a></li>
<li><a class="reference internal" href="#watchtower.CloudWatchLogHandler.createLock"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler.createLock()</span></code></a></li>
<li><a class="reference internal" href="#watchtower.CloudWatchLogHandler.emit"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler.emit()</span></code></a></li>
<li><a class="reference internal" href="#watchtower.CloudWatchLogHandler.flush"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler.flush()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#watchtower.WatchtowerError"><code class="docutils literal notranslate"><span class="pre">WatchtowerError</span></code></a></li>
<li><a class="reference internal" href="#watchtower.WatchtowerWarning"><code class="docutils literal notranslate"><span class="pre">WatchtowerWarning</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#change-log">Change log</a></li>
</ul>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/index.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="watchtower-python-cloudwatch-logging">
<h1>Watchtower: Python CloudWatch Logging<a class="headerlink" href="#watchtower-python-cloudwatch-logging" title="Link to this heading">¶</a></h1>
<p>Watchtower is a log handler for <a class="reference external" href="https://aws.amazon.com/blogs/aws/cloudwatch-log-service/">Amazon Web Services CloudWatch Logs</a>.</p>
<p>CloudWatch Logs is a log management service built into AWS. It is conceptually similar to services like Splunk, Datadog,
and Loggly, but is more lightweight, cheaper, and tightly integrated with the rest of AWS.</p>
<p>Watchtower, in turn, is a lightweight adapter between the <a class="reference external" href="https://docs.python.org/library/logging.html">Python logging system</a> and CloudWatch Logs. It uses the <a class="reference external" href="https://github.com/boto/boto3">boto3 AWS SDK</a>, and lets you plug your application logging directly into CloudWatch without the need
to install a system-wide log collector like <a class="reference external" href="https://pypi.python.org/pypi/awscli-cwlogs">awscli-cwlogs</a> and round-trip
your logs through the instance’s syslog. It aggregates logs into batches to avoid sending an API request per each log
message, while guaranteeing a delivery deadline (60 seconds by default).</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">watchtower</span>
</pre></div>
</div>
</section>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Link to this heading">¶</a></h2>
<p>Install <a class="reference external" href="https://pypi.python.org/pypi/awscli">awscli</a> and set your AWS credentials (run <code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">configure</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">watchtower</span><span class="o">,</span><span class="w"> </span><span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">watchtower</span><span class="o">.</span><span class="n">CloudWatchLogHandler</span><span class="p">())</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Hi&quot;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="p">{}))</span>
</pre></div>
</div>
<p>After running the example, you can see the log output in your <a class="reference external" href="https://console.aws.amazon.com/cloudwatch/home">AWS console</a> under the <strong>watchtower</strong> log group.</p>
</section>
<section id="iam-permissions">
<h2>IAM permissions<a class="headerlink" href="#iam-permissions" title="Link to this heading">¶</a></h2>
<p>The process running watchtower needs to have access to IAM credentials to call the CloudWatch Logs API. The standard
procedure for loading and configuring credentials is described in the
<a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html">Boto3 Credentials documentation</a>.
When running Watchtower on an EC2 instance or other AWS compute resource, boto3 automatically loads credentials from
<a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html">instance metadata</a> (IMDS) or
container credentials provider (AWS_WEB_IDENTITY_TOKEN_FILE or AWS_CONTAINER_CREDENTIALS_FULL_URI). The easiest way to
grant the right permissions to the IAM role associated with these credentials is by attaching an AWS
<a class="reference external" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html">managed IAM policy</a> to the
role. While AWS provides no generic managed CloudWatch Logs writer policy, we recommend that you use the
<code class="docutils literal notranslate"><span class="pre">arn:aws:iam::aws:policy/AWSOpsWorksCloudWatchLogs</span></code> managed policy, which has just the right permissions without being
overly broad.</p>
</section>
<section id="log-group-tagging">
<h2>Log Group Tagging<a class="headerlink" href="#log-group-tagging" title="Link to this heading">¶</a></h2>
<p>Watchtower supports the tagging of log groups. This can be done by adding the parameter <code class="docutils literal notranslate"><span class="pre">log_group_tags</span></code> to the
<code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler</span></code> constructor. This parameter should be a dictionary of tags to apply to the log group.</p>
<p>If you want to add tags to the log group you will need to add permission for the <code class="docutils literal notranslate"><span class="pre">logs:TagResource</span></code> action to your
policy. This will need to be in addition to the AWSOpsWorksCloudWatchLogs policy. (Note: the older <code class="docutils literal notranslate"><span class="pre">logs:TagLogGroup</span></code>
permission is for the <code class="docutils literal notranslate"><span class="pre">tag_log_group()</span></code> call which is on the path to deprecation and is not used by Watchtower.)</p>
</section>
<section id="example-flask-logging-with-watchtower">
<h2>Example: Flask logging with Watchtower<a class="headerlink" href="#example-flask-logging-with-watchtower" title="Link to this heading">¶</a></h2>
<p>Use the following configuration to send Flask logs to a CloudWatch Logs stream called “loggable”:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">watchtower</span><span class="o">,</span><span class="w"> </span><span class="nn">flask</span><span class="o">,</span><span class="w"> </span><span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="s2">&quot;loggable&quot;</span><span class="p">)</span>
<span class="n">handler</span> <span class="o">=</span> <span class="n">watchtower</span><span class="o">.</span><span class="n">CloudWatchLogHandler</span><span class="p">(</span><span class="n">log_group_name</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;werkzeug&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;Hello World!&#39;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>(See also <a class="reference external" href="http://flask.pocoo.org/docs/errorhandling/">http://flask.pocoo.org/docs/errorhandling/</a>.)</p>
</section>
<section id="example-django-logging-with-watchtower">
<h2>Example: Django logging with Watchtower<a class="headerlink" href="#example-django-logging-with-watchtower" title="Link to this heading">¶</a></h2>
<p>This is an example of Watchtower integration with Django. In your Django project, add the following to <code class="docutils literal notranslate"><span class="pre">settings.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>

<span class="n">AWS_REGION_NAME</span> <span class="o">=</span> <span class="s2">&quot;us-west-2&quot;</span>

<span class="n">boto3_logs_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">AWS_REGION_NAME</span><span class="p">)</span>

<span class="n">LOGGING</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;disable_existing_loggers&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;root&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span>
        <span class="c1"># Adding the watchtower handler here causes all loggers in the project that</span>
        <span class="c1"># have propagate=True (the default) to send messages to watchtower. If you</span>
        <span class="c1"># wish to send only from specific loggers instead, remove &quot;watchtower&quot; here</span>
        <span class="c1"># and configure individual loggers below.</span>
        <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;watchtower&#39;</span><span class="p">,</span> <span class="s1">&#39;console&#39;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;console&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;logging.StreamHandler&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;watchtower&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;watchtower.CloudWatchLogHandler&#39;</span><span class="p">,</span>
            <span class="s1">&#39;boto3_client&#39;</span><span class="p">:</span> <span class="n">boto3_logs_client</span><span class="p">,</span>
            <span class="s1">&#39;log_group_name&#39;</span><span class="p">:</span> <span class="s1">&#39;YOUR_DJANGO_PROJECT_NAME&#39;</span><span class="p">,</span>
            <span class="c1"># Decrease the verbosity level here to send only those logs to watchtower,</span>
            <span class="c1"># but still see more verbose logs in the console. See the watchtower</span>
            <span class="c1"># documentation for other parameters that can be set here.</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;DEBUG&#39;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;loggers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># In the debug server (`manage.py runserver`), several Django system loggers cause</span>
        <span class="c1"># deadlocks when using threading in the logging handler, and are not supported by</span>
        <span class="c1"># watchtower. This limitation does not apply when running on production WSGI servers</span>
        <span class="c1"># (gunicorn, uwsgi, etc.), so we recommend that you set `propagate=True` below in your</span>
        <span class="c1"># production-specific Django settings file to receive Django system logs in CloudWatch.</span>
        <span class="s1">&#39;django&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span>
            <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;console&#39;</span><span class="p">],</span>
            <span class="s1">&#39;propagate&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>
        <span class="c1"># Add any other logger-specific configuration here.</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Using this configuration, logs from Django will be sent to Cloudwatch in the log group <code class="docutils literal notranslate"><span class="pre">YOUR_DJANGO_PROJECT_NAME</span></code>.
To supply AWS credentials to this configuration in development, set your
<a class="reference external" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html">AWS CLI profile settings</a> with
<code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">configure</span></code>. To supply credentials in production or when running on an EC2 instance,
assign an IAM role to your instance, which will cause boto3 to automatically ingest IAM role credentials from
<a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html">instance metadata</a>.</p>
<p>(See also the <a class="reference external" href="https://docs.djangoproject.com/en/dev/topics/logging/">Django logging documentation</a>.)</p>
</section>
<section id="examples-querying-cloudwatch-logs">
<h2>Examples: Querying CloudWatch logs<a class="headerlink" href="#examples-querying-cloudwatch-logs" title="Link to this heading">¶</a></h2>
<p>This section is not specific to Watchtower. It demonstrates the use of awscli and jq to read and search CloudWatch logs
on the command line.</p>
<p>For the Flask example above, you can retrieve your application logs with the following two commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aws</span> <span class="n">logs</span> <span class="n">get</span><span class="o">-</span><span class="n">log</span><span class="o">-</span><span class="n">events</span> <span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="n">name</span> <span class="n">watchtower</span> <span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">stream</span><span class="o">-</span><span class="n">name</span> <span class="n">loggable</span> <span class="o">|</span> <span class="n">jq</span> <span class="s1">&#39;.events[].message&#39;</span>
<span class="n">aws</span> <span class="n">logs</span> <span class="n">get</span><span class="o">-</span><span class="n">log</span><span class="o">-</span><span class="n">events</span> <span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="n">name</span> <span class="n">watchtower</span> <span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">stream</span><span class="o">-</span><span class="n">name</span> <span class="n">werkzeug</span> <span class="o">|</span> <span class="n">jq</span> <span class="s1">&#39;.events[].message&#39;</span>
</pre></div>
</div>
<p>In addition to the raw get-log-events API, CloudWatch Logs supports
<a class="reference external" href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/S3Export.html">extraction of your logs into an S3 bucket</a>,
<a class="reference external" href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/AnalyzingLogData.html">log analysis with a query language</a>,
and alerting and dashboards based on <a class="reference external" href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/FilterAndPatternSyntax.html">metric filters</a>, which are pattern
rules that extract information from your logs and feed it to alarms and dashboard graphs. If you want to make use of
these features on the command line, the author of Watchtower has published an open source CLI toolkit called
<a class="reference external" href="https://github.com/kislyuk/aegea">aegea</a> that includes the commands <code class="docutils literal notranslate"><span class="pre">aegea</span> <span class="pre">logs</span></code> and <code class="docutils literal notranslate"><span class="pre">aegea</span> <span class="pre">grep</span></code> to easily
access the S3 Export and Insights features.</p>
</section>
<section id="examples-python-logging-config">
<h2>Examples: Python Logging Config<a class="headerlink" href="#examples-python-logging-config" title="Link to this heading">¶</a></h2>
<p>The Python <code class="docutils literal notranslate"><span class="pre">logging.config</span></code> module has the ability to provide a configuration file that can be loaded in order to
separate the logging configuration from the code.</p>
<p>The following are two example YAML configuration files that can be loaded using PyYAML. The resulting <code class="docutils literal notranslate"><span class="pre">dict</span></code> object
can then be loaded into <code class="docutils literal notranslate"><span class="pre">logging.config.dictConfig</span></code>. The first example is a basic example that relies on the default
configuration provided by <code class="docutils literal notranslate"><span class="pre">boto3</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Default AWS Config</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">disable_existing_loggers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">console</span><span class="p">:</span>
<span class="w">    </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">logging.StreamHandler</span>
<span class="w">    </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG</span>
<span class="w">    </span><span class="nt">stream</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ext://sys.stdout</span>
<span class="w">  </span><span class="nt">logfile</span><span class="p">:</span>
<span class="w">    </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">logging.handlers.RotatingFileHandler</span>
<span class="w">    </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG</span>
<span class="w">    </span><span class="nt">filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">watchtower.log</span>
<span class="w">    </span><span class="nt">maxBytes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000000</span>
<span class="w">    </span><span class="nt">backupCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">  </span><span class="nt">watchtower</span><span class="p">:</span>
<span class="w">    </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">watchtower.CloudWatchLogHandler</span>
<span class="w">    </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG</span>
<span class="w">    </span><span class="nt">log_group_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">watchtower</span>
<span class="w">    </span><span class="nt">log_stream_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{logger_name}-{strftime:%y-%m-%d}&quot;</span>
<span class="w">    </span><span class="nt">send_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">create_log_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">root</span><span class="p">:</span>
<span class="w">  </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG</span>
<span class="w">  </span><span class="nt">propagate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">  </span><span class="nt">handlers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">console</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">logfile</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">watchtower</span><span class="p p-Indicator">]</span>
<span class="nt">loggers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">botocore</span><span class="p">:</span>
<span class="w">    </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INFO</span>
<span class="w">  </span><span class="nt">urllib3</span><span class="p">:</span>
<span class="w">    </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INFO</span>
</pre></div>
</div>
<p>The above works well if you can use the default boto3 credential configuration, or rely on environment variables.
However, sometimes one may want to use different credentials for logging than used for other functionality;
in this case the <code class="docutils literal notranslate"><span class="pre">boto3_profile_name</span></code> option to Watchtower can be used to provide a boto3 profile name:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># AWS Config Profile</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nn">...</span>
<span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">watchtower</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="nt">boto3_profile_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">watchtowerlogger</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<p>Finally, the following shows how to load the configuration into the working application:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging.config</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">flask</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="s2">&quot;loggable&quot;</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;Hello World!&#39;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;logging.yml&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">log_config</span><span class="p">:</span>
        <span class="n">config_yml</span> <span class="o">=</span> <span class="n">log_config</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">config_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">config_yml</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dictConfig</span><span class="p">(</span><span class="n">config_dict</span><span class="p">)</span>
        <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="log-stream-naming">
<h2>Log stream naming<a class="headerlink" href="#log-stream-naming" title="Link to this heading">¶</a></h2>
<p>For high volume logging applications that utilize process pools, it is recommended that you keep the default log stream
name (<code class="docutils literal notranslate"><span class="pre">{machine_name}/{program_name}/{logger_name}/{process_id}</span></code>) or otherwise make it unique per source using a
combination of these template variables. Because logs must be submitted sequentially to each log stream, independent
processes sending logs to the same log stream will encounter sequence token synchronization errors and spend extra resources
automatically recovering from them. As the number of processes increases, this overhead will grow until logs fail to
deliver and get dropped (causing a warning on stderr). Partitioning logs into streams by source avoids this contention.</p>
</section>
<section id="boto3-botocore-urllib3-logs">
<h2>Boto3/botocore/urllib3 logs<a class="headerlink" href="#boto3-botocore-urllib3-logs" title="Link to this heading">¶</a></h2>
<p>Because watchtower uses boto3 to send logs, the act of sending them generates a number of DEBUG level log messages
from boto3’s dependencies, botocore and urllib3. To avoid generating a self-perpetuating stream of log messages,
<code class="docutils literal notranslate"><span class="pre">watchtower.CloudWatchLogHandler</span></code> attaches a
<a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Handler.addFilter">filter</a> to itself which drops all DEBUG
level messages from these libraries, and drops all messages at all levels from them when shutting down (specifically,
in <code class="docutils literal notranslate"><span class="pre">watchtower.CloudWatchLogHandler.flush()</span></code> and <code class="docutils literal notranslate"><span class="pre">watchtower.CloudWatchLogHandler.close()</span></code>). The filter does not
apply to any other handlers you may have processing your messages, so the following basic configuration will cause
botocore debug logs to print to stderr but not to Cloudwatch:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">watchtower</span><span class="o">,</span><span class="w"> </span><span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">watchtower</span><span class="o">.</span><span class="n">CloudWatchLogHandler</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="aws-lambda">
<h2>AWS Lambda<a class="headerlink" href="#aws-lambda" title="Link to this heading">¶</a></h2>
<p>Watchtower is not suitable or necessary for applications running on AWS Lambda. All AWS Lambda logs (i.e. all lines
printed to stderr by the runtime in the Lambda) are automatically sent to CloudWatch Logs, into
<a class="reference external" href="https://console.aws.amazon.com/cloudwatch/home?#logsV2:log-groups$3FlogGroupNameFilter$3D$252Faws$252Flambda">log groups under the /aws/lambda/ prefix</a>.</p>
<p>AWS Lambda <a class="reference external" href="https://docs.aws.amazon.com/lambda/latest/dg/runtimes-context.html">suspends (freezes) all processes in its execution environment</a>
once the invocation is complete and until the next invocation, if any. This means any asynchronous background
processes and threads, including watchtower, will be suspended and inoperable, so watchtower cannot function
correctly in this execution model.</p>
</section>
<section id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Andrey Kislyuk</p></li>
</ul>
</section>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/kislyuk/watchtower">Project home page (GitHub)</a></p></li>
<li><p><a class="reference external" href="https://kislyuk.github.io/watchtower/">Documentation</a></p></li>
<li><p><a class="reference external" href="https://pypi.python.org/pypi/watchtower">Package distribution (PyPI)</a></p></li>
<li><p><a class="reference external" href="https://pypi.python.org/pypi/awscli-cwlogs">AWS CLI CloudWatch Logs plugin</a></p></li>
<li><p><a class="reference external" href="https://github.com/docker/docker/blob/master/daemon/logger/awslogs/cloudwatchlogs.go">Docker awslogs adapter</a></p></li>
</ul>
</section>
<section id="bugs">
<h2>Bugs<a class="headerlink" href="#bugs" title="Link to this heading">¶</a></h2>
<p>Please report bugs, issues, feature requests, etc. on <a class="reference external" href="https://github.com/kislyuk/watchtower/issues">GitHub</a>.</p>
</section>
<section id="versioning">
<h2>Versioning<a class="headerlink" href="#versioning" title="Link to this heading">¶</a></h2>
<p>This package follows the <a class="reference external" href="http://semver.org/">Semantic Versioning 2.0.0</a> standard. To control changes, it is
recommended that application developers pin the package version and manage it using <a class="reference external" href="https://github.com/jazzband/pip-tools">pip-tools</a> or similar. For library developers, pinning the major version is
recommended.</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading">¶</a></h2>
<p>Licensed under the terms of the <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.</p>
<a class="reference external image-reference" href="https://github.com/kislyuk/watchtower/actions"><img alt="https://github.com/kislyuk/watchtower/workflows/CI/badge.svg" src="https://github.com/kislyuk/watchtower/workflows/CI/badge.svg" />
</a>
<a class="reference external image-reference" href="https://codecov.io/github/kislyuk/watchtower?branch=master"><img alt="https://codecov.io/github/kislyuk/watchtower/coverage.svg?branch=master" src="https://codecov.io/github/kislyuk/watchtower/coverage.svg?branch=master" />
</a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/watchtower"><img alt="https://img.shields.io/pypi/v/watchtower.svg" src="https://img.shields.io/pypi/v/watchtower.svg" />
</a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/watchtower"><img alt="https://img.shields.io/pypi/l/watchtower.svg" src="https://img.shields.io/pypi/l/watchtower.svg" />
</a>
</section>
</section>
<section id="module-watchtower">
<span id="api-documentation"></span><h1>API documentation<a class="headerlink" href="#module-watchtower" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="watchtower.CloudWatchLogFormatter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">watchtower.</span></span><span class="sig-name descname"><span class="pre">CloudWatchLogFormatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_serialize_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_log_record_attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watchtower.html#CloudWatchLogFormatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watchtower.CloudWatchLogFormatter" title="Link to this definition">¶</a></dt>
<dd><p>Log formatter for CloudWatch messages. Transforms logged message into a message compatible with the CloudWatch API.
This is the default formatter for CloudWatchLogHandler.</p>
<p>This log formatter is designed to accommodate structured log messages by correctly serializing them as JSON, which
is automatically recognized, parsed, and indexed by CloudWatch Logs. To use this feature, pass a dictionary input
to the logger instead of a plain string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">watchtower</span><span class="o">.</span><span class="n">CloudWatchLogHandler</span><span class="p">())</span>
<span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">({</span><span class="s2">&quot;request&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">9000</span><span class="p">}})</span>
</pre></div>
</div>
<p>If the optional <cite>add_log_record_attrs</cite> attribute or keyword argument is set, it enables the forwarding of specified
<a class="reference external" href="https://docs.python.org/3/library/logging.html#logrecord-attributes">LogRecord attributes</a> with the message.
In this mode, if the message is not already a dictionary, it is converted to one with the original message under the
<cite>msg</cite> key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">handler</span> <span class="o">=</span> <span class="n">watchtower</span><span class="o">.</span><span class="n">CloudWatchLogHandler</span><span class="p">()</span>
<span class="n">handler</span><span class="o">.</span><span class="n">formatter</span><span class="o">.</span><span class="n">add_log_record_attrs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;levelname&quot;</span><span class="p">,</span> <span class="s2">&quot;filename&quot;</span><span class="p">,</span> <span class="s2">&quot;process&quot;</span><span class="p">,</span> <span class="s2">&quot;thread&quot;</span><span class="p">]</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">({</span><span class="s2">&quot;request&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">9000</span><span class="p">}})</span>
</pre></div>
</div>
<p>The resulting raw CloudWatch Logs event will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1636868049692</span><span class="p">,</span>
 <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s1">&#39;{&quot;request&quot;: &quot;hello&quot;,</span>
              <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">9000</span><span class="p">},</span>
              <span class="s2">&quot;levelname&quot;</span><span class="p">:</span> <span class="s2">&quot;CRITICAL&quot;</span><span class="p">,</span>
              <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;/path/to/app.py&quot;</span><span class="p">,</span>
              <span class="s2">&quot;process&quot;</span><span class="p">:</span> <span class="mi">74542</span><span class="p">,</span>
              <span class="s2">&quot;thread&quot;</span><span class="p">:</span> <span class="mi">4659336704</span><span class="p">}</span><span class="s1">&#39;,</span>
 <span class="s2">&quot;ingestionTime&quot;</span><span class="p">:</span> <span class="mi">1636868050028</span><span class="p">}</span>
</pre></div>
</div>
<p>This enables sending log message metadata as structured log data instead of relying on string formatting.
See <a class="reference external" href="https://docs.python.org/3/library/logging.html#logrecord-attributes">LogRecord attributes</a> for the full list
of available attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>json_serialize_default</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em> | </em><em>None</em>) – The ‘default’ function to use when serializing dictionaries as JSON. See the
<a class="reference external" href="https://docs.python.org/3/library/json.html#json.dump">JSON module documentation</a>
for more details about the ‘default’ parameter. By default, watchtower uses a serializer that formats datetime
objects into strings using the <cite>datetime.isoformat()</cite> method, and uses <cite>repr()</cite> to represent all other objects.</p></li>
<li><p><strong>add_log_record_attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="watchtower.CloudWatchLogFormatter.format">
<span class="sig-name descname"><span class="pre">format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watchtower.html#CloudWatchLogFormatter.format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watchtower.CloudWatchLogFormatter.format" title="Link to this definition">¶</a></dt>
<dd><p>Format the specified record as text.</p>
<p>The record’s attribute dictionary is used as the operand to a
string formatting operation which yields the returned string.
Before formatting the dictionary, a couple of preparatory steps
are carried out. The message attribute of the record is computed
using LogRecord.getMessage(). If the formatting string uses the
time (as determined by a call to usesTime(), formatTime() is
called to format the event time. If there is exception information,
it is formatted using formatException() and appended to the message.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="watchtower.CloudWatchLogHandler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">watchtower.</span></span><span class="sig-name descname"><span class="pre">CloudWatchLogHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_group_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'watchtower'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_stream_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'{machine_name}/{program_name}/{logger_name}/{process_id}'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_queues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">send_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1048576</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boto3_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boto3_profile_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_log_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_group_tags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_serialize_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_group_retention_days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_log_stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_message_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">262144</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watchtower.html#CloudWatchLogHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watchtower.CloudWatchLogHandler" title="Link to this definition">¶</a></dt>
<dd><p>Create a new CloudWatch log handler object. This is the main entry point to the functionality of the module. See
the <a class="reference external" href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/WhatIsCloudWatchLogs.html">CloudWatch Logs developer guide</a> and the
<a class="reference external" href="https://docs.python.org/3/library/logging.html">Python logging module documentation</a> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_group_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the CloudWatch log group to write logs to. By default, the name of this module is used.</p></li>
<li><p><strong>log_stream_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the CloudWatch log stream to write logs to. By default, a string containing the machine name, the
program name, and the name of the logger that processed the message is used. Accepts the following format string
parameters: {machine_name}, {program_name}, {logger_name}, {process_id}, {thread_name}, and {strftime:%m-%d-%y},
where a strftime string can be used to include the current UTC datetime in the stream name. The strftime
format string option can be used to sort logs into streams on an hourly, daily, or monthly basis. Note
CloudWatch does not allow colons in the log stream name, so for the strftime placeholder to work, a format
string without colons must be specified.</p></li>
<li><p><strong>use_queues</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If <strong>True</strong> (the default), logs will be queued on a per-stream basis and sent in batches. To manage the queues,
a queue handler thread will be spawned. You can set this to False to make it easier to debug threading issues in
your application. Setting this to False in production is not recommended, since it will cause performance issues
due to the synchronous sending of one CloudWatch API request per log message.</p></li>
<li><p><strong>send_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum time (in seconds, or a timedelta) to hold messages in queue before sending a batch.</p></li>
<li><p><strong>max_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum size (in bytes) of the queue before sending a batch. From CloudWatch Logs documentation: <em>The maximum
batch size is 1,048,576 bytes, and this size is calculated as the sum of all event messages in UTF-8, plus 26
bytes for each log event.</em></p></li>
<li><p><strong>max_batch_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum number of messages in the queue before sending a batch. From CloudWatch Logs documentation: <em>The
maximum number of log events in a batch is 10,000.</em></p></li>
<li><p><strong>boto3_client</strong> (<em>BaseClient</em>) – <p>Client object for sending boto3 logs. Use this to pass custom session or client parameters. For example,
to specify a custom region:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CloudWatchLogHandler</span><span class="p">(</span><span class="n">boto3_client</span><span class="o">=</span><span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s2">&quot;us-west-2&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>See the
<a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/core/session.html">boto3 session reference</a>
for details about the available session and client options.</p>
</p></li>
<li><p><strong>boto3_profile_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of the boto3 configuration profile to use. This option is provided for situations where the logger should
use a different AWS client configuration from the rest of the system, but declarative configuration via a static
dictionary or config file is desired.</p></li>
<li><p><strong>create_log_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Create CloudWatch Logs log group if it does not exist.  <strong>True</strong> by default.</p></li>
<li><p><strong>log_group_retention_days</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>) – Sets the retention policy of the log group in days.  <strong>None</strong> by default.</p></li>
<li><p><strong>log_group_tags</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – Tag the log group with the specified tags and values. There is no provision for removing tags. <strong>{}</strong> by default.</p></li>
<li><p><strong>create_log_stream</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Create CloudWatch Logs log stream if it does not exist.  <strong>True</strong> by default.</p></li>
<li><p><strong>json_serialize_default</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em> | </em><em>None</em>) – <p>The ‘default’ function to use when serializing dictionaries as JSON. See the
<a class="reference external" href="https://docs.python.org/3/library/json.html#json.dump">JSON module documentation</a>
for more details about the ‘default’ parameter. By default, watchtower uses a serializer that formats datetime
objects into strings using the <cite>datetime.isoformat()</cite> method, and uses <cite>repr()</cite> to represent all other objects.</p>
</p></li>
<li><p><strong>max_message_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum size (in bytes) of a single message.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="watchtower.CloudWatchLogHandler.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/watchtower.html#CloudWatchLogHandler.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watchtower.CloudWatchLogHandler.close" title="Link to this definition">¶</a></dt>
<dd><p>Send any queued messages to CloudWatch and prevent further processing of messages.
This method does nothing if <code class="docutils literal notranslate"><span class="pre">use_queues</span></code> is set to False.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watchtower.CloudWatchLogHandler.createLock">
<span class="sig-name descname"><span class="pre">createLock</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/watchtower.html#CloudWatchLogHandler.createLock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watchtower.CloudWatchLogHandler.createLock" title="Link to this definition">¶</a></dt>
<dd><p>Acquire a thread lock for serializing access to the underlying I/O.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watchtower.CloudWatchLogHandler.emit">
<span class="sig-name descname"><span class="pre">emit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watchtower.html#CloudWatchLogHandler.emit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watchtower.CloudWatchLogHandler.emit" title="Link to this definition">¶</a></dt>
<dd><p>Do whatever it takes to actually log the specified logging record.</p>
<p>This version is intended to be implemented by subclasses and so
raises a NotImplementedError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watchtower.CloudWatchLogHandler.flush">
<span class="sig-name descname"><span class="pre">flush</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/watchtower.html#CloudWatchLogHandler.flush"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watchtower.CloudWatchLogHandler.flush" title="Link to this definition">¶</a></dt>
<dd><p>Send any queued messages to CloudWatch. This method does nothing if <code class="docutils literal notranslate"><span class="pre">use_queues</span></code> is set to False.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="watchtower.WatchtowerError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">watchtower.</span></span><span class="sig-name descname"><span class="pre">WatchtowerError</span></span><a class="reference internal" href="_modules/watchtower.html#WatchtowerError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watchtower.WatchtowerError" title="Link to this definition">¶</a></dt>
<dd><p>Default exception class for the watchtower module.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="watchtower.WatchtowerWarning">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">watchtower.</span></span><span class="sig-name descname"><span class="pre">WatchtowerWarning</span></span><a class="reference internal" href="_modules/watchtower.html#WatchtowerWarning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watchtower.WatchtowerWarning" title="Link to this definition">¶</a></dt>
<dd><p>Default warning class for the watchtower module.</p>
</dd></dl>

</section>
<section id="change-log">
<h1>Change log<a class="headerlink" href="#change-log" title="Link to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v3-4-0-2025-02-25">Changes for v3.4.0 (2025-02-25)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v3-3-1-2024-08-20">Changes for v3.3.1 (2024-08-20)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v3-3-0-2024-08-19">Changes for v3.3.0 (2024-08-19)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v3-2-0-2024-04-19">Changes for v3.2.0 (2024-04-19)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v3-1-0-2024-03-10">Changes for v3.1.0 (2024-03-10)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v3-0-1-2023-01-29">Changes for v3.0.1 (2023-01-29)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v3-0-0-2022-01-26">Changes for v3.0.0 (2022-01-26)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-1-1-2022-01-07">Changes for v2.1.1 (2022-01-07)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-1-0-2022-01-07">Changes for v2.1.0 (2022-01-07)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-0-1-2021-11-29">Changes for v2.0.1 (2021-11-29)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-0-0-2021-11-13">Changes for v2.0.0 (2021-11-13)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v1-0-6-2021-01-17">Changes for v1.0.6 (2021-01-17)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v1-0-5-2021-01-13">Changes for v1.0.5 (2021-01-13)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v1-0-4-2021-01-01">Changes for v1.0.4 (2021-01-01)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v1-0-3-2021-01-01">Changes for v1.0.3 (2021-01-01)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v1-0-2-2020-12-31">Changes for v1.0.2 (2020-12-31)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v1-0-1-2020-12-21">Changes for v1.0.1 (2020-12-21)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v1-0-0-2020-10-28">Changes for v1.0.0 (2020-10-28)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-8-0-2020-06-28">Changes for v0.8.0 (2020-06-28)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-7-3-2019-08-27">Changes for v0.7.3 (2019-08-27)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-7-2-2019-08-26">Changes for v0.7.2 (2019-08-26)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-7-1-2019-08-26">Changes for v0.7.1 (2019-08-26)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-7-0-2019-08-26">Changes for v0.7.0 (2019-08-26)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-6-0-2019-05-22">Changes for v0.6.0 (2019-05-22)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-5-5-2019-01-22">Changes for v0.5.5 (2019-01-22)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-5-4-2018-11-02">Changes for v0.5.4 (2018-11-02)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-5-3-2018-04-16">Changes for v0.5.3 (2018-04-16)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-5-2-2017-11-09">Changes for v0.5.2 (2017-11-09)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-5-1-2017-11-09">Changes for v0.5.1 (2017-11-09)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-5-0-2017-11-09">Changes for v0.5.0 (2017-11-09)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-4-1-2017-09-20">Changes for v0.4.1 (2017-09-20)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-4-0-2017-08-11">Changes for v0.4.0 (2017-08-11)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-3-3-2016-09-15">Changes for v0.3.3 (2016-09-15)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-3-2-2016-09-15">Changes for v0.3.2 (2016-09-15)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-3-1-2016-09-15">Changes for v0.3.1 (2016-09-15)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v0-3-0-2016-09-15">Changes for v0.3.0 (2016-09-15)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-2-0-2016-03-22">Version 0.2.0 (2016-03-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-8-2016-03-08">Version 0.1.8 (2016-03-08)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-6-2015-12-13">Version 0.1.6 (2015-12-13)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-5-2015-12-13">Version 0.1.5 (2015-12-13)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-4-2015-11-20">Version 0.1.4 (2015-11-20)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-3-2015-10-04">Version 0.1.3 (2015-10-04)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-2-2015-09-07">Version 0.1.2 (2015-09-07)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-1-2015-04-29">Version 0.1.1 (2015-04-29)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-1-0-2015-04-29">Version 0.1.0 (2015-04-29)</a></li>
</ul>
</li>
</ul>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="changelog.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Release Notes</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Andrey Kislyuk
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Watchtower: Python CloudWatch Logging</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li><a class="reference internal" href="#iam-permissions">IAM permissions</a></li>
<li><a class="reference internal" href="#log-group-tagging">Log Group Tagging</a></li>
<li><a class="reference internal" href="#example-flask-logging-with-watchtower">Example: Flask logging with Watchtower</a></li>
<li><a class="reference internal" href="#example-django-logging-with-watchtower">Example: Django logging with Watchtower</a></li>
<li><a class="reference internal" href="#examples-querying-cloudwatch-logs">Examples: Querying CloudWatch logs</a></li>
<li><a class="reference internal" href="#examples-python-logging-config">Examples: Python Logging Config</a></li>
<li><a class="reference internal" href="#log-stream-naming">Log stream naming</a></li>
<li><a class="reference internal" href="#boto3-botocore-urllib3-logs">Boto3/botocore/urllib3 logs</a></li>
<li><a class="reference internal" href="#aws-lambda">AWS Lambda</a></li>
<li><a class="reference internal" href="#authors">Authors</a></li>
<li><a class="reference internal" href="#links">Links</a></li>
<li><a class="reference internal" href="#bugs">Bugs</a></li>
<li><a class="reference internal" href="#versioning">Versioning</a></li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-watchtower">API documentation</a><ul>
<li><a class="reference internal" href="#watchtower.CloudWatchLogFormatter"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogFormatter</span></code></a><ul>
<li><a class="reference internal" href="#watchtower.CloudWatchLogFormatter.format"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogFormatter.format()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#watchtower.CloudWatchLogHandler"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler</span></code></a><ul>
<li><a class="reference internal" href="#watchtower.CloudWatchLogHandler.close"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler.close()</span></code></a></li>
<li><a class="reference internal" href="#watchtower.CloudWatchLogHandler.createLock"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler.createLock()</span></code></a></li>
<li><a class="reference internal" href="#watchtower.CloudWatchLogHandler.emit"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler.emit()</span></code></a></li>
<li><a class="reference internal" href="#watchtower.CloudWatchLogHandler.flush"><code class="docutils literal notranslate"><span class="pre">CloudWatchLogHandler.flush()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#watchtower.WatchtowerError"><code class="docutils literal notranslate"><span class="pre">WatchtowerError</span></code></a></li>
<li><a class="reference internal" href="#watchtower.WatchtowerWarning"><code class="docutils literal notranslate"><span class="pre">WatchtowerWarning</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#change-log">Change log</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>